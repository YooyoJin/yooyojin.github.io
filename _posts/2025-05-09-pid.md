---
title: PID控制器
author: YooyoJin
date: 2025-05-09
category: Jekyll
layout: post
mermaid: true
---

PID算法是一种常见的反馈控制算法，应用广泛，包含单不限于电机控制、温控。

之前直接抄现成的代码适配功能，调参。没有真正意义上去深入理解其精髓。本章主要参考王晓明教授的《电动机的单片机控制》，针对“数字PID控制器与数字滤波”这一章内容学习总结。

## 1. 模拟PID

PID控制有三个基本要件：比例(proportional)、积分(integral)、微分(derivative)。

PID采集周期（循环周期）也是闭环系统的重要参数，因为有些时候传感器离执行器较远，过程变量改变和观测到该改变之间的时间延迟，也就是不响应期。


``` mermaid
graph LR
    A[设定值] --> B((比较器))
    B -->|误差值| C[PID控制器]
    C --> D[电动机]
    D -->|传感器反馈| B
```
_**说明**_
 - 误差值$e(t)$ = 设定值$r(t)$ - 传感器反馈的实际值$y(t)$
 - 通过调节控制量$u(t)$来使系统的输出$y(t)$尽可能接近期望的设定值$r(t)$

误差值$e(t)$ 作为输入，$u(t)$作为PID的输出和被控对象的输入。所以模拟PID的控制规律为

$u(t) = K_p e(t) + K_i \int_0^t e(t) \, dt + K_d \frac{de(t)}{dt} + u_0$
_**说明**_
 - $K_p$ 比例系数
 - $K_i$ 积分常数
 - $K_d$ 微分常数
 - $u_0$ 控制常量

> **比例响应**
> 比例模块仅仅取决于设定值和过程变量之间的差值。这个差值被称为“误差”。比例环节的作用是对偏差瞬态做出快速反应。偏差一点产生，控制器立即起作用。但是，如果比例增益太大，过程变量会出现振荡，$K_p$过大会使得系统变得不稳定，以至于失控。

> **$u_0$**
> 大部分被控制对象（如直流电机的调压调速），要适当加上与转速和负载有关的控制常量，否则，比例环节将会产生静态误差

> **积分响应**
> 积分模块将一段时间内的误差相加。即使是一个很小的误差，也会让积分响应缓慢增加。积分响应会根据时间持续增加，除非误差为0。因此，积分响应的目的在于将稳定状态的误差保持在0，起到一个消除静态误差的作用，但也会降低系统响应速度，增加系统引起的超调量。

> **微分响应**
> 微分环节的作用是阻止偏差的变化。根据偏差的变化趋势（变化速度）进行控制。偏差变化的越快，微分控制器的输出越大。引入微分有助减少超调量，是系统趋于稳定。微分对噪声比较敏感。

## 2. 模拟PID




## 3. PID调整

设置P、I、D最佳增益，从而得到控制系统理想反馈的过程叫做整定。 PID整定方法有很多种。本文主要介绍试错法和Ziegler Nichols法。

位置式 PID 控制算法和增量式 PID 控制算法之间存在密切的关系，可以通过增量式算法推导出位置式的递推公式。以下是详细的推导过程：

### 1. 位置式 PID 控制算法
位置式 PID 的输出 \( u_k \) 直接表示控制量的绝对值，其公式为：

\[
u_k = K_p e_k + K_i \sum_{j=0}^{k} e_j + K_d (e_k - e_{k-1})
\]
其中：
- \( K_p \) 是比例增益，
- \( K_i \) 是积分增益，
- \( K_d \) 是微分增益，
- \( e_k \) 是当前时刻的误差，
- \( \sum_{j=0}^{k} e_j \) 是误差的累加和。

### 2. 增量式 PID 控制算法
增量式 PID 的输出 \( \Delta u_k \) 表示控制量的变化量，其公式为：
\[
\Delta u_k = K_p (e_k - e_{k-1}) + K_i e_k + K_d (e_k - 2e_{k-1} + e_{k-2})
\]
增量式算法只计算当前控制量相对于上一次的变化。

### 3. 从增量式推导位置式的递推公式
位置式的输出 \( u_k \) 可以表示为上一次的输出 \( u_{k-1} \) 加上当前的增量 \( \Delta u_k \)：
\[
u_k = u_{k-1} + \Delta u_k
\]
将增量式 PID 的 \( \Delta u_k \) 代入上式：
\[
u_k = u_{k-1} + K_p (e_k - e_{k-1}) + K_i e_k + K_d (e_k - 2e_{k-1} + e_{k-2})
\]
这就是位置式 PID 的递推计算公式。

### 4. 推导的意义
通过递推公式，位置式 PID 可以避免直接计算误差的累加和 \( \sum_{j=0}^{k} e_j \)，从而减少计算量和内存占用。每次只需保存上一次的输出 \( u_{k-1} \) 和最近的几次误差值 \( e_k, e_{k-1}, e_{k-2} \)，即可完成计算。

### 总结
位置式 PID 的递推公式 \( u_k = u_{k-1} + \Delta u_k \) 是通过将增量式 PID 的输出 \( \Delta u_k \) 叠加到上一次的输出 \( u_{k-1} \) 上得到的。这种形式简化了实现过程，同时保持了控制算法的完整性。


## 参考资料

[PID控制器及其原理解释](https://www.ni.com/zh-cn/shop/labview/pid-theory-explained.html?srsltid=AfmBOoqWDqgwnvU19vFPLYO2AVHofH_WpVnJrkRhmNcJGRDRGauZNIqa)